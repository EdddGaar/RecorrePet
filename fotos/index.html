<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DEBUG | Re Corre Pet</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f0f0; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        button { width: 100%; padding: 15px; margin: 10px 0; border: none; border-radius: 8px; font-weight: bold; background: #1D71B8; color: white; }
        
        /* CONSOLA DE LOGS EN PANTALLA */
        #debug-console { 
            background: #222; color: #0f0; font-family: monospace; font-size: 10px; 
            padding: 10px; margin-top: 20px; border-radius: 10px; 
            height: 150px; overflow-y: scroll; text-align: left;
        }
    </style>
</head>
<body>

    <div class="card">
        <h3>üîç Panel de Diagn√≥stico</h3>
        <p id="browser-info" style="font-size: 10px; color: #666;"></p>
        
        <button onclick="fixBrowser()" style="background: #00C853;">1. PROBAR SALTO (INTENT)</button>
        <button onclick="abrirCamara()">2. PROBAR C√ÅMARA</button>
        
        <input type="file" id="fileIn" accept="image/*" style="display:none" onchange="log('Archivo seleccionado!')">
    </div>

    <div id="debug-console">--- SISTEMA DE LOGS INICIADO ---<br></div>

    <script>
        const consoleDiv = document.getElementById('debug-console');
        const _supabase = supabase.createClient('https://fjdkteumrfeiaprgumsa.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZqZGt0ZXVtcmZlaWFwcmd1bXNhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MjY1ODMsImV4cCI6MjA4MzMwMjU4M30.6Nt1DzfHjx7xdZPfpiatngxC6E00MBHFVYA-aPLPfAI');

        function log(msg) {
            const t = new Date().toLocaleTimeString();
            consoleDiv.innerHTML += `[${t}] ${msg}<br>`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        // Detectar User Agent
        const ua = navigator.userAgent;
        document.getElementById('browser-info').innerText = ua;
        log("UserAgent detectado.");

        function fixBrowser() {
            log("Intentando salto 'intent://'...");
            try {
                const url = "intent://" + window.location.host + window.location.pathname + "#Intent;scheme=https;package=com.android.chrome;end";
                log("URL generada: " + url);
                window.location.href = url;
                
                // Si despu√©s de 2 segundos sigue aqu√≠, es que el intent fall√≥
                setTimeout(() => {
                    log("‚ö†Ô∏è El salto fall√≥. Intentando m√©todo alternativo...");
                    window.open("https://googlechrome.google.com/test", "_blank");
                }, 2000);
            } catch (e) {
                log("ERROR en fixBrowser: " + e.message);
            }
        }

        function abrirCamara() {
            log("Solicitando clic en input file...");
            const input = document.getElementById('fileIn');
            
            if (!input) {
                log("‚ùå ERROR: No se encontr√≥ el elemento fileIn");
                return;
            }

            try {
                input.click();
                log("‚úÖ Ejecutado: input.click()");
            } catch (e) {
                log("‚ùå ERROR al abrir c√°mara: " + e.message);
            }
        }

        // Capturar errores globales del sistema
        window.onerror = function(m, u, l) {
            log(`CRASH: ${m} en l√≠nea ${l}`);
        };
    </script>
</body>
</html>
